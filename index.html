<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.11.0/d3.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <title>D3</title>
    <link rel="stylesheet" href="styles.css">
</head>
<div style="padding: 0;">
  <header class="style-guide__header">
    <img class="style-guide__header__logo" src="header-logo.svg" alt="Timescale">
    <span>The Inner Workings of TimescaleDB</span>
  </header>
</div>
<div>
  <body>
    <script>
      function tabulate(data, columns) {
        var table = d3.select('body').append('table')
        var thead = table.append('thead')
        var	tbody = table.append('tbody');

        console.log(data)
        // append the header row
        thead.append('tr')
          .selectAll('th')
          .data(columns).enter()
          .append('th')
            .text(function (column) { return column; });

        // create a row for each object in the data
        var rows = tbody.selectAll('tr')
          .data(data)
          .enter()
          .append('tr');

        // create a cell in each row for each column
        var cells = rows.selectAll('td')
          .data(function (row) {
            return columns.map(function (column) {
              return {column: column, value: row[column]};
            });
          })
          .enter()
          .append('td')
            .text(function (d) { return d.value; });

        return table;
      }

      var request = new XMLHttpRequest();
      var data;

      // populate with all tables
      request.open('GET', 'http://localhost:8000/all_tables', true)
      request.onload = function() {
        // Begin accessing JSON data here
        data = JSON.parse(this.response)

        if (request.status >= 200 && request.status < 400) {
          tabulate(data, ['table_schema', 'table_name']);
        }
      }
      request.send();
      
    </script>
  </body>
</div>
</html>
